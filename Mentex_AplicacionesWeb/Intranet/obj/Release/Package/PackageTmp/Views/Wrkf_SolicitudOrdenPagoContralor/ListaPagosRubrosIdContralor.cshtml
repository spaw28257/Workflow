@using System.Web

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MENTEX C.A.</title>
    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">

    <!-- Font Awesome -->
    <link href="~/Adminlte/plugins/fontawesome-free/css/all.min.css" rel="stylesheet" />
    <!-- DataTables -->
    <link href="~/Adminlte/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
    <link href="~/Adminlte/plugins/datatables-responsive/css/responsive.bootstrap4.min.css" rel="stylesheet" />
    <link href="~/Adminlte/plugins/datatables-buttons/css/buttons.bootstrap4.min.css" rel="stylesheet" />
    <!-- Theme style -->
    <link href="~/Adminlte/css/adminlte.min.css" rel="stylesheet" />
    <link href="~/Adminlte/css/mentex.css" rel="stylesheet" />

    <!---mensajes sweetalert-->
    <script src="~/Adminlte/plugins/sweetalert2/sweetalert.min.js"></script>

</head>
<body class="hold-transition sidebar-mini layout-fixed" onload="CargarPagosContraloria()">
    <div class="wrapper">

        <!-- Preloader -->
        <div class="preloader flex-column justify-content-center align-items-center">
            <img src="~/Adminlte/img/Iphone-spinner-2.gif" class="animation__shake brand-image img-rounded elevation-3" alt="Mentex C.A." height="40" width="40" />
        </div>

        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="@Url.Action("Index", "Home")" class="nav-link"><i class="fas fa-home"></i>&nbsp;Inicio</a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="@Url.Action("CerrarSesion", "Wrkf_Login")" class="nav-link"><i class="fas fa-lock"></i>&nbsp;Cerrar Sesión</a>
                </li>
            </ul>
        </nav>
        <!-- /.navbar -->
        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-dark-light elevation-4">
            <!-- Brand Logo -->
            <a href="#" class="brand-link">
                <img src="~/Adminlte/img/LogoWorkflow.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
                <span class="brand-text font-weight-light">MENTEX C.A.</span>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar user panel (optional) -->
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="~/Adminlte/img/user_undefine160x160.png" class="img-circle elevation-2" alt="User Image" />
                    </div>
                    <div class="info">
                        <a href="#" class="d-block">@Session["sUsuario_Id"]</a>
                    </div>
                </div>

                <!-- Sidebar Menu -->
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false" id="ulOpcionesMenu">

                        @foreach (var listadomenu in ViewBag.listaropcionesmenu)
                        {
                            <li class="nav - item">
                                <p>
                                    <a href="@Url.Action(@listadomenu.Accionx, @listadomenu.Controladorx)"><i class="@listadomenu.Imagenx"></i>&nbsp;@listadomenu.Menux</a>
                                </p>
                            </li>
                        }

                    </ul>
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <br />
            <!-- Main content -->
            <section class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header" style="background-color:#82293E;">
                                    <h3 class="card-title" style="color:#FFFFFF;">Solicitudes de Pagos Pendientes por Revisar Por Contraloria:</h3>
                                </div>
                                <!-- /.card-header -->
                                <div class="card-body" id="MostarPagos" style="width:100%; height:850px; overflow-y: auto;">

                                </div>
                                <!-- /.card-body -->
                            </div>
                            <!-- /.card -->
                        </div>
                        <!-- /.col -->
                    </div>
                </div><!-- /.container-fluid -->
            </section>
            <!-- /.content -->
        </div>

        <!-- /.modal -->
        <!--Mostar las observaciones de la solicitud del pago-->
        <div class="modal fade" id="modal-xl1">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Observaciones de la Solicitud de Pago</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header cabecera-tabla">
                                            <h3 class="card-title" id="txtnumobssolicitud">&nbsp;</h3>
                                        </div>
                                        <!-- /.card-header -->
                                        <div class="card-body">
                                            <p class="justificar-parrafo" id="txtobservacionessoli"></p>
                                        </div>
                                        <!-- /.card-body -->
                                    </div>
                                    <!-- /.card -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>

        <!-- /.modal -->
        <!--Ver el detalle de la solicitud del pago que esta aprobando o rechazando-->
        <div class="modal fade" id="modal-xl2">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Detalle de la Solicitud de Pago</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header cabecera-tabla">
                                            <h3 class="card-title">Datos de la Solicitud</h3>
                                        </div>
                                        <!-- /.card-header -->
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <label>Tipo de Documento:</label>
                                                    <input type="text" name="txttipodocumento" id="txttipodocumento" class="form-control" readonly />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Moneda:</label>
                                                    <input type="text" name="txtmoneda" id="txtmoneda" class="form-control" readonly />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Porcentaje de Retención:</label>
                                                    <input type="text" name="txtporcentajeretencion" id="txtporcentajeretencion" class="form-control" style="text-align:right;" readonly />
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-4">
                                                    <label>Grupo del rubro:</label>
                                                    <input type="text" name="txtgruporubro" id="txtgruporubro" class="form-control" readonly style="text-align:left;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Rubro:</label>
                                                    <input type="text" name="txtrubro" id="txtrubro" class="form-control" readonly style="text-align:left;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Fecha Creación:</label>
                                                    <input type="text" name="txtfechacreacion" id="txtfechacreacion" class="form-control" style="text-align:left;" readonly />
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-4">
                                                    <label>Fecha Pago:</label>
                                                    <input type="text" name="txtfechapago" id="txtfechapago" class="form-control" readonly style="text-align:left;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>R.I.F:</label>
                                                    <input type="text" name="txtrif" id="txtrif" class="form-control" readonly style="text-align:left;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Proveedor:</label>
                                                    <input type="text" name="txtproveedor" id="txtproveedor" class="form-control" style="text-align:left;" readonly />
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-4">
                                                    <label>Descripción:</label>
                                                    <input type="text" name="txtdescripcion" id="txtdescripcion" class="form-control" readonly style="text-align:left;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Número Documento / Factura / NC:</label>
                                                    <input type="text" name="txtnumdocumento" id="txtnumdocumento" class="form-control" readonly style="text-align:left;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Forma de Pago:</label>
                                                    <input type="text" name="txtformapago" id="txtformapago" class="form-control" style="text-align:left;" readonly />
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-4">
                                                    <label>Monto a Pagar:</label>
                                                    <input type="text" name="txtmontoapagar" id="txtmontoapagar" class="form-control" readonly style="text-align:right;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Anticipos:</label>
                                                    <input type="text" name="txtanticipo" id="txtanticipo" class="form-control" readonly style="text-align: right;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Porcentaje I.V.A:</label>
                                                    <input type="text" name="txtporcentajeiva" id="txtporcentajeiva" class="form-control" style="text-align: right;" readonly />
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-4">
                                                    <label>Total I.V.A:</label>
                                                    <input type="text" name="txttotaliva" id="txttotaliva" class="form-control" readonly style="text-align: right;" />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>Total Retenido:</label>
                                                    <input type="text" name="txttotalretenido" id="txttotalretenido" class="form-control" style="text-align: right;" readonly />
                                                </div>
                                                <div class="col-md-4">
                                                    <label>SubTotal A Pagar:</label>
                                                    <input type="text" name="txtsubtotalpagar" id="txtsubtotalpagar" class="form-control" style="text-align: right;" readonly />
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label>Total A Pagar:</label>
                                                    <input type="text" name="txttotalapagar" id="txttotalapagar" class="form-control alinear-derecha" readonly />
                                                </div>
                                            </div>
                                        </div>
                                        <!-- /.card-body -->
                                    </div>
                                    <!-- /.card -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <!-- /.modal -->
        <!-- /.modal -->
        <!--Mostar las observaciones de la solicitud del pago-->
        <div class="modal fade" id="modal-xl3">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Observaciones</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header cabecera-tabla">
                                            <h3 class="card-title" id="txtrechazosolicitudnum">Motivo del Rechazo de la Solicitud N°</h3>
                                        </div>
                                        <!-- /.card-header -->
                                        <div class="card-body">
                                            <textarea class="form-control" id="txtmotivorechazo" rows="4" cols="80"></textarea>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12" style="text-align:right">
                                                <button type="button" class="btn btn-success" onclick="MotivoRechazo()">
                                                    <i class="fas fa-save"></i>&nbsp;Agregar Observación
                                                </button>
                                                @*<input type="button" class="btn btn-success" value="Agregar Observación" onclick="MotivoRechazo()" />*@
                                            </div>
                                        </div>
                                        <!-- /.card-body -->
                                    </div>
                                    <!-- /.card -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>

        <!-- /.modal -->
        <!--Filtrar por rango de fecha pago-->
        <div class="modal fade" id="modal-xl4">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Filtrar Por Fecha de Pago</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header cabecera-tabla">
                                            <h3 class="card-title" id="txtnumobssolicitud">Seleccione el rango de fecha</h3>
                                        </div>
                                        <!-- /.card-header -->
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <form name="frmpagossubcontra" id="frmpagossubcontra" method="post"
                                                          action="@Url.Action("ListaPagosPorRubroIdSubContraloriaPost", "Wrkf_SolicitudSubContralor")">
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label for="txtfechadesde">Fecha de Pago Desde</label>
                                                                    <input type="hidden" name="gruporubro_id" id="gruporubro_id" value="@ViewBag.gruporubro_id" />
                                                                    <input type="hidden" name="rubro_id" id="rubro_id" value="@ViewBag.rubro_id" />
                                                                    <input type="hidden" name="prioridadpago" id="prioridadpago" value="@ViewBag.prioridadpago" />
                                                                    <input type="date" class="form-control" name="txtfechadesde"
                                                                           id="txtfechadesde" style="background-color: oldlace;" value="@ViewBag.fechadesde" />
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label for="txtfechahasta">Fecha de Pago Hasta</label>
                                                                    <input type="date" class="form-control" name="txtfechahasta"
                                                                           id="txtfechahasta" style="background-color: oldlace;" value="@ViewBag.fechahasta" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-12 alinear-centro">
                                                                <button type="submit" name="btnvolveramostrar" id="btnvolveramostrar" class="btn btn-default">
                                                                    <i class="fas fa-search"></i>&nbsp;Buscar Pagos
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- /.card-body -->
                                    </div>
                                    <!-- /.card -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <!-- /.modal -->

        <footer class="main-footer">
            @*<strong>Copyright &copy; 2014-2021 <a href="https://adminlte.io">AdminLTE.io</a>.</strong>All rights reserved.*@
            <div class="float-right d-none d-sm-inline-block">
                <b>WorkFlow Cuentas Por Pagar Version</b> 1.0
            </div>
        </footer>

        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
        </aside>
        <!-- /.control-sidebar -->
    </div>
    <!-- ./wrapper -->
    <!-- jQuery -->
    <script src="~/Adminlte/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="~/Adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables  & Plugins -->
    <script src="~/Adminlte/plugins/datatables/jquery.dataTables.js"></script>
    <script src="~/Adminlte/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/Adminlte/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/Adminlte/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
    <script src="~/Adminlte/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/Adminlte/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>

    <!-- AdminLTE App -->
    <script src="~/Adminlte/js/adminlte.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="~/Adminlte/js/demo.js"></script>

    <script src="~/Scripts/UtilidadesVarias.js"></script>

    <!-- Page specific script -->
    <script>

        /*carga los pagos pendientes por aprobar o rechazar por contraloria*/
        function CargarPagosContraloria() {
            var vGrupoRubro_Id = $("#gruporubro_id").val();
            var vRubro_Id = $("#rubro_id").val();
            var vFechaPagoDesde = $("#txtfechadesde").val();
            var vFechaPagoHasta = $("#txtfechahasta").val();
            var vPrioridadPago = $("#prioridadpago").val();

            var parametros = {
                "pgruporubro_id": vGrupoRubro_Id,
                "prubro_id": vRubro_Id,
                "pfechapagodesde": vFechaPagoDesde,
                "pfechapagohasta": vFechaPagoHasta,
                "pprioridadpago": vPrioridadPago
            };

            $.ajax({
                type: 'POST',
                url: '@Url.Action("ObtenerPagosPorAprobarContraloria", "Wrkf_SolicitudOrdenPagoContralor")',
                content: "application/json; charset=utf-8",
                dataType: 'json',
                data: parametros,
                success: function (data) {
                    if (data[0].Codigox.length > 0) {
                        swal(data[0].Mensajex, data[0].Titulox, data[0].Tipox);
                    } else {
                        var strHtml = '<div class="row">'; /*1*/
                        for (i = 0; i < data.length; i++) {
                            var vCodigoPagoAprobar = "'" + data[i].Codigo + "', 'A', 'txtobservaciones_" + i + "'";
                            var vCodigoPagoAnular = "'" + data[i].Codigo + "', 'R', 'txtobservaciones_" + i + "'";
                            var vCodigoPagoSoporte = "'" + data[i].Codigo + "'";
                            var vEsPagoUrgente = '';

                            if (data[i].PagoUrgente == true) {
                                vEsPagoUrgente = 'Sí';
                            } else {
                                vEsPagoUrgente = 'No';
                            }

                            strHtml += '<div class="col-lg-12 col-12">'; /*2*/
                            strHtml += '<div class="small-box" style="background-color:#FFFFFF; border-color:#000000">'; /*3*/
                            strHtml += '<div class="inner">' /*4*/
                            strHtml += '<div class="row">'; /*5*/
                            strHtml += '<div class="col-lg-12 col-12">';/*6*/
                            strHtml += '<h5 style="color:#FFFFFF; background-color:#82293E;">&nbsp;Pago N°:&nbsp;' + data[i].Codigo + '</h5>';
                            strHtml += '</div>';/*6*/
                            strHtml += '</div>';/*5*/

                            strHtml += '<div class="row">';/*7*/

                            strHtml += '<div class="col-md-3">';/*8*/
                            strHtml += '<u><b>Grupo Rubro:</b></u>';
                            strHtml += '</div>';/*8*/

                            strHtml += '<div class="col-md-3">';/*9*/
                            strHtml += data[i].GrupoRubroDescripcion;
                            strHtml += '</div>';/*9*/

                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Rubro:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += data[i].RubroDescripcion;
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Proveedor:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += data[i].GAPProveedor;
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>IdProveedor:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += data[i].GAPIdProveedor;
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-md-3 col-6">';/*8*/
                            strHtml += '<u><b>N° Factura:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += data[i].GAPNroFactura;
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Fecha Factura:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += data[i].GAPFechaFactura.substring(0, 10);
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Fecha Pago:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += data[i].GAPFechaPago.substring(0, 10);
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Total a Pagar:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += '<b>' + number_format(parseFloat(data[i].GAPMonto), 2, ',', '.') + '</b>';
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Id Chequera:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += '<b>' + data[i].GAPIdChequera + '</b>';
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Código Moneda:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += '<b>' + data[i].CodigoMoneda + '</b>';
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>¿Es Urgente?:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += '<b>' + vEsPagoUrgente + '</b>';
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3 col-6">';/*8*/
                            strHtml += '<u><b>Observaciones:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-3 col-6">';/*9*/
                            strHtml += '<textarea row="2" cols="100" id="txtobservaciones_' + i+ '" class="form-control"></textarea>';
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '<div class="row">';/*7*/
                            strHtml += '<div class="col-lg-3">';/*8*/
                            strHtml += '<u><b>Acciones:</b></u>';
                            strHtml += '</div>';/*8*/
                            strHtml += '<div class="col-lg-6">';/*9*/
                            strHtml += '<a href="#" style="color:green;" onclick="AprobarRechazarSolicitudContraloria(' + vCodigoPagoAprobar + ')" title="Aprobar Pago"><i class="fas fa-check"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
                            strHtml += '<a href="#" style="color:orange;" onclick="AprobarRechazarSolicitudContraloria(' + vCodigoPagoAnular + ')" title="Anular Pago"><i class="fas fa-trash"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
                            strHtml += '<a href="#" style="color:black;" onclick="VerSoporte(' + vCodigoPagoSoporte + ')" title="Ver Soportes del Pago"><i class="fas fa-file"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
                            strHtml += '</div>';/*9*/
                            strHtml += '</div>';/*7*/

                            strHtml += '</div>';/*4*/
                            strHtml += '</div>';/*3*/
                            strHtml += '</div>';/*2*/
                        }
                        strHtml += '</div>';/*1*/
                        $("#MostarPagos").html(strHtml);
                    }
                },
                error: function (jqXHR, exception) {
                    var msg = '';
                    if (jqXHR.status === 0) {
                        msg = 'Not connect.\n Verify Network.';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 404) {
                        msg = 'Requested page not found. [404]';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 500) {
                        msg = 'Internal Server Error [500].';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'parsererror') {
                        msg = 'Requested JSON parse failed.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'timeout') {
                        msg = 'Time out error.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'abort') {
                        msg = 'Ajax request aborted.';
                        swal(msg, 'Error', 'error');
                    } else {
                        msg = 'Uncaught Error.\n' + jqXHR.responseText;
                        swal(msg, 'Error', 'error');
                    }
                }
            });
        }

        //obtener las observaciones de la solicitud de pago
        function ObtieneObservacionesSolicitud(pSolicitudordenpagodetalle_Id, pSolicitudordenpago_Id) {
            var parametros = {
                "Solicitudordenpagodetalle_Id": pSolicitudordenpagodetalle_Id,
                "Solicitudordenpago_Id": pSolicitudordenpago_Id
            };

            $.ajax({
                type: 'POST',
                url: '@Url.Action("ObtieneObservacionesSolicitud", "Wrkf_SolicitudOrdenPagoCxP")',
                content: "application/json; charset=utf-8",
                dataType: 'json',
                data: parametros,
                success: function (data) {

                    if (data.Codigox.length == 0) {
                        $("#txtnumobssolicitud").html("");
                        $("#txtnumobssolicitud").html("Solicitud de Pago Número:" + pSolicitudordenpago_Id);
                        $("#txtobservacionessoli").html("");
                        $("#txtobservacionessoli").html(data.Observacionesx);
                    } else {
                        swal(data.Codigox + ' ' + data.Mensajex, data.Titulox, data.Tipox);
                    }
                },
                error: function (jqXHR, exception) {
                    var msg = '';
                    if (jqXHR.status === 0) {
                        msg = 'Not connect.\n Verify Network.';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 404) {
                        msg = 'Requested page not found. [404]';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 500) {
                        msg = 'Internal Server Error [500].';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'parsererror') {
                        msg = 'Requested JSON parse failed.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'timeout') {
                        msg = 'Time out error.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'abort') {
                        msg = 'Ajax request aborted.';
                        swal(msg, 'Error', 'error');
                    } else {
                        msg = 'Uncaught Error.\n' + jqXHR.responseText;
                        swal(msg, 'Error', 'error');
                    }
                }
            });
        }

        //obtine el detalle de la solicitud
        function ObtieneDetalleCompletoSolicitud(pSolicitudordenpagodetalle_Id, pSolicitudordenpago_Id) {
            var parametros = {
                "Solicitudordenpagodetalle_Id": pSolicitudordenpagodetalle_Id,
                "Solicitudordenpago_Id": pSolicitudordenpago_Id
            };

            $.ajax({
                type: 'POST',
                url: '@Url.Action("DetalleCompletoSolicitudPagoCxP", "Wrkf_SolicitudOrdenPagoCxP")',
                content: "application/json; charset=utf-8",
                dataType: 'json',
                data: parametros,
                success: function (data) {
                    $("#txttipodocumento").val(data[0].DescripTipoDocumentox);
                    $("#txtmoneda").val(data[0].Curncyid);
                    $("#txtporcentajeretencion").val(data[0].Porcentajeretencionx);

                    $("#txtgruporubro").val(data[0].DescripGrupoRubrox);
                    $("#txtrubro").val(data[0].DescripRubrox);
                    $("#txtfechacreacion").val(data[0].Fecharegistrox);

                    $("#txtfechapago").val(data[0].Fechapagox);
                    $("#txtrif").val(data[0].Rifx);
                    $("#txtproveedor").val(data[0].Proveedorx);

                    $("#txtdescripcion").val(data[0].Descripcionx);
                    $("#txtnumdocumento").val(data[0].Numerodocumentox);
                    $("#txtformapago").val(data[0].DescripFormaPagox);

                    $("#txtmontoapagar").val(data[0].Preciounitariox);
                    $("#txtanticipo").val(data[0].Anticipox);
                    $("#txtporcentajeiva").val(data[0].Porcentajeivax);

                    $("#txttotaliva").val(data[0].MontoIvax);
                    $("#txttotalretenido").val(data[0].Totalretenidox);
                    $("#txtsubtotalpagar").val(data[0].Subtotalx);
                    $("#txttotalapagar").val(data[0].Totalx);

                },
                error: function (jqXHR, exception) {
                    var msg = '';
                    if (jqXHR.status === 0) {
                        msg = 'Not connect.\n Verify Network.';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 404) {
                        msg = 'Requested page not found. [404]';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 500) {
                        msg = 'Internal Server Error [500].';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'parsererror') {
                        msg = 'Requested JSON parse failed.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'timeout') {
                        msg = 'Time out error.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'abort') {
                        msg = 'Ajax request aborted.';
                        swal(msg, 'Error', 'error');
                    } else {
                        msg = 'Uncaught Error.\n' + jqXHR.responseText;
                        swal(msg, 'Error', 'error');
                    }
                }
            });
        }

        //Aprobar o Rechazar las solicitudes de pago por contraloria
        function AprobarRechazarSolicitudContraloria(pcodigopago, paccion, pcampoobservacion) {

            var vTitulo = '';
            var vMensaje = '';
            var vIcono = '';

            if (pcodigopago == '') {
                swal('El pago seleccionado debe ser valido', 'Aprobar o Anular Pagos Contraloria', 'error');
            } else {

                if (paccion == 'A') {
                    vTitulo = 'Aprobar Pagos por Contraloria';
                    vMensaje = 'El pago N° ' + pcodigopago + 'sera aprobado y enviado al para la aprobación del VP de Finanzas';
                    vIcono = 'success';
                } else if (paccion == 'R') {
                    vTitulo = 'Anulación Pagos por SubContraloria';
                    vMensaje = 'El pago N° ' + pcodigopago + 'sera anulado en las aplicaciones workflow y GAP';
                    vIcono = 'error';
                } else if (paccion == 'U') {
                    vTitulo = 'Marcar Pagos Urgentes';
                    vMensaje = 'El pago N° ' + pcodigopago + 'sera marcado como urgente';
                    vIcono = 'warning';
                } else {
                    return;
                }

                swal({
                    title: vTitulo,
                    text: vMensaje,
                    icon: vIcono,
                    buttons: true,
                    successMode: true,
                })
                .then((willDelete) => {
                    if (willDelete) {

                        var parametros = {
                            "pcodigo": pcodigopago,
                            "pobservaciones": $("#" + pcampoobservacion).val(),
                            "paccion": paccion
                        };

                        $.ajax({
                            type: 'POST',
                            url: '@Url.Action("AprobarRechazarSolicitudContraloria", "Wrkf_SolicitudOrdenPagoContralor")',
                            content: "application/json; charset=utf-8",
                            dataType: 'json',
                            data: parametros,
                            success: function (data) {
                                if (data.Codigox.length > 0) {
                                    swal(data.Codigox + " " + data.Mensajex, data.Titulox, data.Tipox);
                                } else {
                                    swal("La solicitud de pago fue procesada con éxito", "Información", "info");
                                    $("#MostarPagos").html('');
                                    CargarPagosContraloria();
                                }
                            },
                            error: function (jqXHR, exception) {
                                var msg = '';
                                if (jqXHR.status === 0) {
                                    msg = 'Not connect.\n Verify Network.';
                                    swal(msg, 'Error', 'error');
                                } else if (jqXHR.status == 404) {
                                    msg = 'Requested page not found. [404]';
                                    swal(msg, 'Error', 'error');
                                } else if (jqXHR.status == 500) {
                                    msg = 'Internal Server Error [500].';
                                    swal(msg, 'Error', 'error');
                                } else if (exception === 'parsererror') {
                                    msg = 'Requested JSON parse failed.';
                                    swal(msg, 'Error', 'error');
                                } else if (exception === 'timeout') {
                                    msg = 'Time out error.';
                                    swal(msg, 'Error', 'error');
                                } else if (exception === 'abort') {
                                    msg = 'Ajax request aborted.';
                                    swal(msg, 'Error', 'error');
                                } else {
                                    msg = 'Uncaught Error.\n' + jqXHR.responseText;
                                    swal(msg, 'Error', 'error');
                                }
                            }
                        });
                    }
                })
            }
        }

        //descargar soporte de la solicitud
        function Descargarsoporte(url) {
            window.open(url, "_blank", "directories=no,location=no,menubar=no,status=no,titlebar=no,toolbar=no,scrollbars=yes,resizable=no,top=500,left=500,width=500,height=500");
        }

        //Asignar Pagos Urgentes
        function AsignarPagoUrgente(psolicitudordenpago_Id, psolicitudordenpagodetalle_Id) {

            var pagourgente = false;
            var chkurgente = document.getElementsByName("chkurgente");

            for (x = 0; x < chkurgente.length; x++) {
                if (chkurgente[x].checked) {
                    pagourgente = true;
                }
            }

            var parametros = {
                "Solicitudordenpagodetalle_Id": psolicitudordenpagodetalle_Id,
                "Solicitudordenpago_Id": psolicitudordenpago_Id,
                "pagourgente": pagourgente
            };

            $.ajax({
                type: 'POST',
                url: '@Url.Action("AsignarPagoUrgente", "Wrkf_SolicitudSubContralor")',
                content: "application/json; charset=utf-8",
                dataType: 'json',
                data: parametros,
                success: function (data) {
                    if (data.Codigox.length > 0) {
                        swal(data.Codigox + " " + data.Mensajex, data.Titulox, data.Tipox);
                    }
                },
                error: function (jqXHR, exception) {
                    var msg = '';
                    if (jqXHR.status === 0) {
                        msg = 'Not connect.\n Verify Network.';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 404) {
                        msg = 'Requested page not found. [404]';
                        swal(msg, 'Error', 'error');
                    } else if (jqXHR.status == 500) {
                        msg = 'Internal Server Error [500].';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'parsererror') {
                        msg = 'Requested JSON parse failed.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'timeout') {
                        msg = 'Time out error.';
                        swal(msg, 'Error', 'error');
                    } else if (exception === 'abort') {
                        msg = 'Ajax request aborted.';
                        swal(msg, 'Error', 'error');
                    } else {
                        msg = 'Uncaught Error.\n' + jqXHR.responseText;
                        swal(msg, 'Error', 'error');
                    }
                }
            });
        }

        //imprime un reporte de la solicitud enviada a CxP
        function ImprimirPagosPendientesArea() {

            var screenWidth = screen.width;
            var screenHeight = screen.height;

            var url = '@Url.Action("GenerarReportePagosPendientes", "Wrkf_Reporte")';

            window.open(url, '_blank', 'toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=' + screenWidth + ',height=' + screenHeight);
        }

        /*Muestra los soportes del pago*/
        function VerSoporte(pCodigo) {
            if (pCodigo == '') {
                swal("Seleccione el pago para listar los soportes", "Advertencia", "warning");
            } else {
                var vUrl = '@Url.Action("DescargarSoporte", "Wrk_SolicitudOrdenPagoSoporte")';
                var urldescarga = vUrl + '?pCodigo=' + pCodigo;
                window.open(urldescarga, "_blank", "directories=no,location=no,menubar=no,status=no,titlebar=no,toolbar=no,scrollbars=yes,resizable=no,top=500,left=500,width=500,height=500");
            }
        }
    </script>
</body>
</html>